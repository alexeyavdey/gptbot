# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è LLM-–∞–Ω–∞–ª–∏–∑–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–¥–∞—á

## –ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥

–í–º–µ—Å—Ç–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π AI-–∞–≥–µ–Ω—Ç TaskSelectorAgent**, –∫–æ—Ç–æ—Ä—ã–π –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø–æ–º–æ—â—å—é LLM –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

### 1. TaskSelectorAgent - –ê–≥–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏–π

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –∏ –∏—Å—Ç–æ—Ä–∏—é —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è:
- –ö–∞–∫–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Ö–æ—á–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (delete/update/view/create)
- –ö–∞–∫–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏–º–µ–µ—Ç –≤ –≤–∏–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å  
- –£—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –≤—ã–±–æ—Ä–µ
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**:
```python
{
  "user_message": "—É–¥–∞–ª–∏ –∑–∞–¥–∞—á—É –ø—Ä–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é",
  "tasks": [
    {
      "task_id": "uuid",
      "title": "–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∞–π—Ç–∞ –ë–∞–Ω–∫–∞",
      "description": "–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é",
      "status": "pending",
      "priority": "high"
    }
  ],
  "conversation_history": [
    {"role": "user", "content": "–ø–æ–∫–∞–∂–∏ –∑–∞–¥–∞—á—É –ø—Ä–æ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é"},
    {"role": "assistant", "content": "–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∞–π—Ç–∞ –ë–∞–Ω–∫–∞"}
  ]
}
```

**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**:
```json
{
  "action": "delete",
  "selected_tasks": [
    {
      "task_id": "uuid",
      "title": "–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∞–π—Ç–∞ –ë–∞–Ω–∫–∞",
      "confidence": 0.95,
      "reasoning": "–ù–∞–π–¥–µ–Ω–æ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º '—Å—Ç—Ä–∞—Ç–µ–≥–∏—è'"
    }
  ],
  "requires_confirmation": true,
  "suggested_response": "–ù–∞–π–¥–µ–Ω–∞ –∑–∞–¥–∞—á–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º"
}
```

### 2. TaskManagementAgent - –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∞–≥–µ–Ω—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TaskSelectorAgent**:
```python
class TaskManagementAgent(BaseAgent):
    def __init__(self, api_key: str, model: str = "gpt-4.1"):
        super().__init__(api_key, model)
        self.task_selector = TaskSelectorAgent(api_key, model)  # –ù–æ–≤—ã–π –∞–≥–µ–Ω—Ç
        
    async def process_message(self, user_id: int, message: str, context: Dict = None):
        # 1. –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–¥–∞—á –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        tasks = self.db.get_tasks(user_id)
        
        # 2. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞–º–µ—Ä–µ–Ω–∏–µ —á–µ—Ä–µ–∑ TaskSelectorAgent
        intent_analysis = await self.task_selector.analyze_user_intent(
            user_message=message,
            tasks=tasks,
            conversation_history=context.get('conversation_history', [])
        )
        
        # 3. –í—ã–ø–æ–ª–Ω—è–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ
        action = intent_analysis.get('action')
        selected_tasks = intent_analysis.get('selected_tasks', [])
        
        if action == 'delete':
            return await self._handle_delete_action(user_id, selected_tasks, ...)
        elif action == 'view':
            return await self._handle_view_action(user_id, selected_tasks)
        # ... –¥—Ä—É–≥–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
```

## –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

### 1Ô∏è‚É£ **–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**
```python
# –ü–æ–ª—É—á–∞–µ–º –í–°–ï –∑–∞–¥–∞—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
tasks = self.db.get_tasks(user_id)

# –ü–æ–ª—É—á–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞  
conversation_history = context.get('conversation_history', [])
```

### 2Ô∏è‚É£ **LLM-–∞–Ω–∞–ª–∏–∑ –Ω–∞–º–µ—Ä–µ–Ω–∏—è**
```python
intent_analysis = await self.task_selector.analyze_user_intent(
    user_message="—É–¥–∞–ª–∏ –∑–∞–¥–∞—á—É –ø—Ä–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é",
    tasks=tasks,  # –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å task_id
    conversation_history=conversation_history
)
```

**LLM –ø–æ–ª—É—á–∞–µ—Ç**:
- –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á —Å ID, –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏, –æ–ø–∏—Å–∞–Ω–∏—è–º–∏, —Å—Ç–∞—Ç—É—Å–∞–º–∏, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 5 —Å–æ–æ–±—â–µ–Ω–∏–π —Ä–∞–∑–≥–æ–≤–æ—Ä–∞

**LLM –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç**:
- –£–ø–æ–º–∏–Ω–∞–Ω–∏—è —á–∞—Å—Ç–∏—á–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π ("—Å—Ç—Ä–∞—Ç–µ–≥–∏—è" ‚Üí –Ω–∞—Ö–æ–¥–∏—Ç –∑–∞–¥–∞—á–∏ —Å–æ —Å–ª–æ–≤–æ–º "—Å—Ç—Ä–∞—Ç–µ–≥–∏—è")
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏ ("—ç—Ç—É –∑–∞–¥–∞—á—É", "–µ—ë", "–ø–æ—Å–ª–µ–¥–Ω—é—é" ‚Üí –∏—â–µ—Ç –≤ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞)
- –ú–æ—Ä—Ñ–æ–ª–æ–≥–∏—é —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞ ("—Å—Ç—Ä–∞—Ç–µ–≥–∏—é" = "—Å—Ç—Ä–∞—Ç–µ–≥–∏—è")
- –£—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –≤—ã–±–æ—Ä–µ

### 3Ô∏è‚É£ **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞**
```python
action = intent_analysis.get('action')           # delete/update/view/create
selected_tasks = intent_analysis.get('selected_tasks', [])  # –°–ø–∏—Å–æ–∫ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á —Å task_id
requires_confirmation = intent_analysis.get('requires_confirmation', True)

if action == 'delete':
    if len(selected_tasks) == 1 and requires_confirmation:
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–¥–∞—á—É –∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
        return format_confirmation_request(selected_tasks[0])
    elif len(selected_tasks) > 1:
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∏ –ø—Ä–æ—Å–∏–º —É—Ç–æ—á–Ω–∏—Ç—å
        return format_selection_request(selected_tasks)
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

### ‚úÖ **–£–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞**
- **–ü–æ–Ω–∏–º–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫**: "—É–¥–∞–ª–∏ –µ—ë" –ø–æ—Å–ª–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏
- **–ú–æ—Ä—Ñ–æ–ª–æ–≥–∏—è**: "—Å—Ç—Ä–∞—Ç–µ–≥–∏—é" –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç "–°—Ç—Ä–∞—Ç–µ–≥–∏—è –±–∞–Ω–∫–∞"
- **–ß–∞—Å—Ç–∏—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è**: "–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è" –Ω–∞—Ö–æ–¥–∏—Ç "–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è –í–ª–∞–¥–∞"

### ‚úÖ **–£—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏**
```json
{
  "selected_tasks": [
    {
      "task_id": "uuid",
      "confidence": 0.95,  // –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å = –º–æ–∂–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø—Ä—è–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ
      "reasoning": "–¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º"
    }
  ]
}
```

### ‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç–∏**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "—É–¥–∞–ª–∏ –∑–∞–¥–∞—á—É –ø—Ä–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é"
–ù–∞–π–¥–µ–Ω–æ: 3 –∑–∞–¥–∞—á–∏

LLM –∞–Ω–∞–ª–∏–∑ ‚Üí selected_tasks: [task1, task2, task3]
–°–∏—Å—Ç–µ–º–∞ ‚Üí "–ù–∞–π–¥–µ–Ω–æ 3 –∑–∞–¥–∞—á–∏, —É—Ç–æ—á–Ω–∏—Ç–µ –≤—ã–±–æ—Ä"
```

### ‚úÖ **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø–∞–º—è—Ç—å**
```
Conversation:
User: "–ø–æ–∫–∞–∂–∏ –∑–∞–¥–∞—á—É –ø—Ä–æ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é" 
Bot: "–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∞–π—Ç–∞ –ë–∞–Ω–∫–∞ ‚Äî –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –í–ª–∞–¥–∞"
User: "–¥–∞–≤–∞–π –µ—ë —É–¥–∞–ª–∏–º"  ‚Üê LLM –ø–æ–Ω–∏–º–∞–µ—Ç —á—Ç–æ "–µ—ë" = –∑–∞–¥–∞—á–∞ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
```

## –ü—Ä–∏–º–µ—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –¢–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
```
üë§ "—É–¥–∞–ª–∏ –∑–∞–¥–∞—á—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –±–∞–Ω–∫–∞"
üß† LLM –∞–Ω–∞–ª–∏–∑: action=delete, confidence=0.95, 1 –∑–∞–¥–∞—á–∞ –Ω–∞–π–¥–µ–Ω–∞
ü§ñ "–ù–∞–π–¥–µ–Ω–∞ –∑–∞–¥–∞—á–∞: –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∞–π—Ç–∞ –ë–∞–Ω–∫–∞. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ?"
üë§ "–¥–∞"  
ü§ñ "–ó–∞–¥–∞—á–∞ —É–¥–∞–ª–µ–Ω–∞!"
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è
```
üë§ "—É–¥–∞–ª–∏ –∑–∞–¥–∞—á—É –ø—Ä–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é"
üß† LLM –∞–Ω–∞–ª–∏–∑: action=delete, 3 –∑–∞–¥–∞—á–∏ –Ω–∞–π–¥–µ–Ω—ã
ü§ñ "–ù–∞–π–¥–µ–Ω–æ 3 –∑–∞–¥–∞—á–∏ —Å–æ —Å–ª–æ–≤–æ–º '—Å—Ç—Ä–∞—Ç–µ–≥–∏—è':
     1. –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∞–π—Ç–∞ –ë–∞–Ω–∫–∞
     2. –°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞  
     3. –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è
     –ö–∞–∫—É—é —É–¥–∞–ª–∏—Ç—å?"
üë§ "–ø–µ—Ä–≤—É—é"
üß† LLM –∞–Ω–∞–ª–∏–∑: "–ø–µ—Ä–≤—É—é" ‚Üí task_id –ø–µ—Ä–≤–æ–π –∑–∞–¥–∞—á–∏
ü§ñ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ: –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∞–π—Ç–∞ –ë–∞–Ω–∫–∞?"
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è —Å—Å—ã–ª–∫–∞
```
üë§ "–ø–æ–∫–∞–∂–∏ –∑–∞–¥–∞—á—É –ø—Ä–æ –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é"
ü§ñ "–°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∞–π—Ç–∞ –ë–∞–Ω–∫–∞ ‚Äî –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è –í–ª–∞–¥–∞"
üë§ "—É–¥–∞–ª–∏ –µ—ë"
üß† LLM –∞–Ω–∞–ª–∏–∑: "–µ—ë" + –∫–æ–Ω—Ç–µ–∫—Å—Ç ‚Üí task_id –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è  
ü§ñ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ: –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–∞–π—Ç–∞ –ë–∞–Ω–∫–∞?"
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ü—Ä–æ–º–ø—Ç –¥–ª—è TaskSelectorAgent
```
–¢—ã - AI-–∞–≥–µ–Ω—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∑–∞–¥–∞—á.

–ü–†–ê–í–ò–õ–ê –ê–ù–ê–õ–ò–ó–ê:
1. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ–≤–æ—Ä–∏—Ç "—ç—Ç—É –∑–∞–¥–∞—á—É", "–µ—ë", "–ø–æ—Å–ª–µ–¥–Ω—é—é" - –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
2. –ï—Å–ª–∏ —É–ø–æ–º–∏–Ω–∞–µ—Ç —á–∞—Å—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è - –∏—â–∏ –ø–æ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é  
3. –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á –ø–æ–¥—Ö–æ–¥—è—Ç - –ø—Ä–µ–¥–ª–æ–∂–∏ —É—Ç–æ—á–Ω–µ–Ω–∏–µ
4. –í—Å–µ–≥–¥–∞ —Ç—Ä–µ–±—É–π –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
5. –£—á–∏—Ç—ã–≤–∞–π –º–æ—Ä—Ñ–æ–ª–æ–≥–∏—é —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞

–í–•–û–î–ù–´–ï –î–ê–ù–ù–´–ï:
- –°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
- –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á —Å ID, –Ω–∞–∑–≤–∞–Ω–∏–µ–º, –æ–ø–∏—Å–∞–Ω–∏–µ–º, —Å—Ç–∞—Ç—É—Å–æ–º, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
- –ò—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

–í–´–•–û–î–ù–´–ï –î–ê–ù–ù–´–ï (JSON):
{
  "action": "delete|update|view|create",
  "selected_tasks": [...],
  "requires_confirmation": true/false,
  "suggested_response": "..."
}
```

### –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π
```python
async def _handle_delete_action(self, user_id, selected_tasks, requires_confirmation):
    if len(selected_tasks) == 1:
        if requires_confirmation:
            return format_confirmation_request(selected_tasks[0])
        else:
            return execute_deletion(selected_tasks[0])
    else:
        return format_selection_request(selected_tasks)

async def _handle_view_action(self, user_id, selected_tasks):
    if selected_tasks:
        return format_specific_tasks(selected_tasks)
    else:
        return get_all_tasks(user_id)
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–∏—Å—Ç–µ–º–æ–π

### OrchestratorAgent
```python
class OrchestratorAgent(BaseAgent):
    def __init__(self, api_key: str, model: str = "gpt-4.1"):
        # ... –¥—Ä—É–≥–∏–µ –∞–≥–µ–Ω—Ç—ã
        self.task_selector = TaskSelectorAgent(api_key, model)  # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –∞–≥–µ–Ω—Ç
        
    async def route_request(self, user_id: int, message: str, user_state: Dict = None):
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è –æ—Å—Ç–∞–µ—Ç—Å—è
        if self._is_deletion_confirmation(message):
            task_id = self._extract_task_id_from_message(message)
            if task_id:
                return await self.task_agent.process_message(
                    user_id, message, {"task_id": task_id}
                )
        
        # –û—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### Mock-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```python
# –¢–µ—Å—Ç —Å –º–æ–∫–∞–º–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–∏–∫–∏
mock_analysis = {
    "action": "delete",
    "selected_tasks": [{"task_id": "test-id", "confidence": 0.95}],
    "requires_confirmation": True
}

with patch.object(task_agent.task_selector, 'analyze_user_intent') as mock_analyze:
    mock_analyze.return_value = mock_analysis
    result = await task_agent.process_message(user_id, "—É–¥–∞–ª–∏ –∑–∞–¥–∞—á—É")
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ  
```bash
python test_task_selector_simple.py  # Mock-—Ç–µ—Å—Ç—ã
python test_llm_task_selection.py    # –¢–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º LLM (—Ç—Ä–µ–±—É–µ—Ç API –∫–ª—é—á)
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–£–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –Ω–∞–º–µ—Ä–µ–Ω–∏–π** - LLM –ø–æ–Ω–∏–º–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Å—Å—ã–ª–∫–∏
‚úÖ **–ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º** - –∞–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –∑–∞–¥–∞—á–∏ —Å task_id
‚úÖ **–£—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏** - —Å–∏—Å—Ç–µ–º–∞ –ø–æ–Ω–∏–º–∞–µ—Ç –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –∑–∞–¥–∞—á–∞  
‚úÖ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ—Å—Ç–∏** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è–º–∏
‚úÖ **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø–∞–º—è—Ç—å** - –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å—Å—ã–ª–æ–∫ —Ç–∏–ø–∞ "—ç—Ç—É –∑–∞–¥–∞—á—É", "–µ—ë"
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –¥–µ–π—Å—Ç–≤–∏–π (update, create, etc.)

–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ –≤—ã –ø—Ä–æ—Å–∏–ª–∏: AI-–∞–≥–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á —Å task_id –∏ –∏—Å—Ç–æ—Ä–∏—é –æ–±—â–µ–Ω–∏—è, –∑–∞—Ç–µ–º —Å –ø–æ–º–æ—â—å—é LLM –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ –∏–º–µ–µ—Ç –≤ –≤–∏–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.